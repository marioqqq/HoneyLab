- name: Configure desktop environment
  hosts: localhost
  become: true
  tasks:
    - name: Remove Firefox
      apt:
        name: firefox
        state: absent
        purge: yes
        autoremove: yes
        update_cache: yes

    - name: Install required packages
      apt:
        name:
          - curl
          - gnupg
        state: present
        update_cache: yes

    - name: Download Brave browser GPG key
      get_url:
        url: https://brave-browser-apt-release.s3.brave.com/brave-browser-archive-keyring.gpg
        dest: /usr/share/keyrings/brave-browser-archive-keyring.gpg

    - name: Add Brave APT repository
      apt_repository:
        repo: "deb [signed-by=/usr/share/keyrings/brave-browser-archive-keyring.gpg] https://brave-browser-apt-release.s3.brave.com/ stable main"
        state: present
        filename: brave-browser

    - name: Update APT cache
      apt:
        update_cache: yes

    - name: Install Brave browser
      apt:
        name: brave-browser
        state: latest

    - name: Download latest VS Code .deb
      shell: |
        curl -L -o /tmp/code_latest.deb "https://code.visualstudio.com/sha/download?build=stable&os=linux-deb-x64"
      args:
        executable: /bin/bash

    - name: Install VS Code
      apt:
        deb: /tmp/code_latest.deb

    - name: Download the .deb file
      get_url:
        url: "https://github.com/rustdesk/rustdesk/releases/download/1.3.9/rustdesk-1.3.9-x86_64.deb"
        dest: "/tmp/rustdesk-1.3.9-x86_64.deb"

    - name: Install the .deb file
      apt:
        deb: "/tmp/rustdesk-1.3.9-x86_64.deb"
        state: present
